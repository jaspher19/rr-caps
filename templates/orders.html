<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order History | RCAPS4STREET</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>body { font-family: 'Inter', sans-serif; }</style>
</head>
<body class="bg-[#0A0A0A] text-white min-h-screen flex flex-col">
  
  <nav class="sticky top-0 z-50 flex justify-between items-center px-6 md:px-12 py-4 bg-black/90 backdrop-blur-md border-b border-white/5">
    <a href="/" class="flex items-center gap-4 group">
      <div class="relative w-10 h-10 overflow-hidden rounded-lg border border-white/10">
        <img src="{{ url_for('static', filename='images/LOGOS/LOGO.jfif') }}" alt="Logo" class="w-full h-full object-cover">
      </div>
      <span class="text-xl font-extrabold tracking-tighter uppercase">RCAPS4 <span class="text-gray-500">STREET</span></span>
    </a>
    
    {% if is_admin %}
    <a href="{{ url_for('admin', key=admin_key) }}" class="text-[10px] uppercase tracking-[0.2em] hover:text-white text-gray-400 transition">← Back to Terminal</a>
    {% else %}
    <a href="/" class="text-[10px] uppercase tracking-[0.2em] hover:text-white text-gray-400 transition">Back to Store</a>
    {% endif %}
  </nav>

  <main class="flex-grow max-w-4xl mx-auto py-20 px-6 w-full">
    <div class="mb-12 border-b border-white/10 pb-6 flex justify-between items-end">
        <div>
            <h1 class="text-4xl font-extrabold uppercase tracking-tighter">
                {% if is_admin %}System Logs{% else %}Purchase History{% endif %}
            </h1>
            <p class="text-gray-500 text-[10px] mt-2 uppercase tracking-[0.3em]">
                {% if is_admin %}Full sequence of customer transactions{% else %}Your lifetime archive with us{% endif %}
            </p>
        </div>
        {% if orders %}
        <span class="text-[10px] text-gray-500 uppercase tracking-widest border border-white/10 px-3 py-1 rounded">
            Total Orders: {{ orders|length }}
        </span>
        {% endif %}
    </div>

    {% if orders and orders is iterable and orders|length > 0 %}
      <div class="space-y-12">
        {% for order in orders | reverse %}
        <div class="border border-white/10 rounded overflow-hidden bg-[#0F0F0F] transition hover:border-white/20">
          
          <div class="bg-white/5 px-6 py-4 flex justify-between items-center border-b border-white/10">
            <div>
              <p class="text-[9px] text-gray-500 uppercase tracking-widest">Order ID</p>
              <p class="text-xs font-mono text-white">#{{ order.get('order_id', 'N/A') }}</p>
            </div>
            <div class="text-right">
              <p class="text-[9px] text-gray-500 uppercase tracking-widest">Date</p>
              <p class="text-xs text-white uppercase">{{ order.get('date', 'Unknown Date') }}</p>
            </div>
          </div>

          <div class="p-6 space-y-4">
            {% for item in order.get('items', []) %}
            <div class="flex items-center justify-between group">
              <div class="flex items-center gap-4">
                <div class="w-14 h-16 bg-black rounded flex items-center justify-center border border-white/5 overflow-hidden">
                    <img src="{{ url_for('static', filename=item.get('image', 'images/products/default.jpg')) }}" 
                         class="w-4/5 h-4/5 object-contain" 
                         alt="{{ item.get('name') }}">
                </div>
                <div>
                    <span class="text-xs font-bold uppercase tracking-wide block text-white">{{ item.get('name', 'Product') }}</span>
                    <span class="text-[9px] text-gray-500 uppercase tracking-widest">Qty: {{ item.get('quantity', 1) }}</span>
                </div>
              </div>
              <span class="text-xs text-gray-400">₱{{ item.get('price', 0) }}</span>
            </div>
            {% endfor %}
          </div>

          <div class="bg-black p-6 border-t border-white/5 flex justify-between items-center">
             <div>
                <p class="text-[9px] uppercase tracking-widest text-gray-500 mb-1">Customer Details</p>
                <p class="text-[10px] text-gray-300 uppercase">{{ order.get('email', 'N/A') }}</p>
                <p class="text-[10px] text-gray-500 uppercase">{{ order.get('shipping', 'No Address') }}</p>
             </div>
             <div class="text-right">
                <p class="text-[9px] uppercase tracking-widest text-gray-500 mb-1">Grand Total</p>
                <p class="text-lg font-black text-white">₱{{ order.get('total', 0) }}</p>
             </div>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-32 border border-dashed border-white/10 rounded bg-white/[0.01]">
        <div class="mb-6 flex justify-center opacity-20">
            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
            </svg>
        </div>
        <p class="text-gray-500 text-[10px] uppercase tracking-[0.4em] mb-8">No previous checkouts found.</p>
        <a href="/" class="inline-block text-[10px] border border-white/20 px-10 py-4 hover:bg-white hover:text-black transition uppercase tracking-widest">Start Your First Order</a>
      </div>
    {% endif %}
  </main>

  <footer class="py-10 text-center border-t border-white/5 mt-auto">
    <p class="text-[9px] text-gray-700 tracking-[0.5em] uppercase">&copy; 2026 RCAPS4STREET INTERACTIVE</p>
  </footer>
</body>
</html>